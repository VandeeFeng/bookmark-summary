# Smuggling arbitrary data through an emoji
- URL: https://paulbutler.org/2025/smuggling-arbitrary-data-through-an-emoji/
- Added At: 2025-02-13 06:10:11
- [Link To Text](2025-02-13-smuggling-arbitrary-data-through-an-emoji_raw.md)

## Summary
**摘要**:
本文主要介绍了如何利用 Unicode 编码中的变体选择器(Variation Selectors)在文本中隐藏数据的方法。Unicode 使用码位(Codepoints)来表示字符,变体选择器用于修改前一个字符的显示方式,本身不显示任何内容。作者发现可以将多个变体选择器连接起来,每个变体选择器代表一个字节的数据,从而在任何 Unicode 字符后隐藏任意字节串。文章详细解释了如何将字节转换为变体选择器,并提供了 Rust 代码示例来演示如何编码和解码数据。例如,可以将 "hello" 编码到 emoji 😊 之后,使其看起来像一个普通的 emoji,但实际包含了隐藏的数据。作者也提到了这种技术的潜在滥用风险,例如绕过内容审查和文本水印。最后,作者还探讨了大型语言模型(LLM)对此类隐藏数据的处理能力,发现虽然 tokenizer 可以保留变体选择器作为 token,但模型本身通常不愿意解码它们。

**要点总结**:
1.  Unicode 码位和变体选择器:Unicode 使用码位表示字符,变体选择器(VS-1 到 VS-256)用于修改前一个字符的显示方式,本身不显示任何内容。变体选择器分为两个范围:U+FE00..U+FE0F 和 U+E0100..U+E01EF。
2.  数据隐藏原理:通过将多个变体选择器连接在一起,每个变体选择器代表一个字节的数据,从而在任何 Unicode 字符后隐藏任意字节串。由于变体选择器在渲染时通常被忽略,因此隐藏的数据对人眼是不可见的。
3.  编码和解码方法:文章提供了 Rust 代码示例,展示了如何将字节转换为变体选择器,并将多个变体选择器连接到基本字符后进行编码。同时,也展示了如何从包含变体选择器的字符串中解码出原始字节数据。编码过程包括将每个字节转换为对应的变体选择器,解码过程则相反,将变体选择器转换回字节。
4.  潜在滥用风险:这种技术可能被用于绕过内容审查,因为隐藏的数据对人眼不可见,人类审核员可能无法检测到。此外,还可以用于文本水印,通过在文本中嵌入隐藏的标识信息,追踪泄露信息的来源。
5.  LLM 的处理能力:大型语言模型(LLM)的 tokenizer 通常会保留变体选择器作为 token,这意味着模型在理论上可以访问这些隐藏的数据。然而,大多数模型本身并不愿意尝试解码这些数据,但结合代码解释器后,某些模型能够成功解码。

