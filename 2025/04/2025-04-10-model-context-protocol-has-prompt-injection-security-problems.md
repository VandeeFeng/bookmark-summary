# Model Context Protocol has prompt injection security problems
- URL: https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/
- Added At: 2025-04-10 06:41:54
- [Link To Text](2025-04-10-model-context-protocol-has-prompt-injection-security-problems_raw.md)

## Summary
**摘要**：
本文主要探讨了模型上下文协议（MCP）在工具安全方面存在的提示注入问题。MCP旨在为LLM（大型语言模型）系统提供工具，但其安全性问题日益凸显。“Rug Pull”攻击，即工具定义在安装后被恶意修改，以及“跨服务器工具阴影”，恶意服务器覆盖或拦截可信服务器的调用，都是严重威胁。更甚者，工具中毒攻击通过在工具描述中隐藏恶意指令，诱导LLM泄露用户私有数据。文章通过一个WhatsApp MCP的案例，展示了攻击者如何利用该协议窃取用户消息历史。核心挑战在于，只要LLM接触到不受信任的输入，并拥有执行操作的工具，就存在潜在风险。文章作者对提示注入问题的长期存在表示担忧，并强调在MCP的客户端和服务端设计中，必须加入人为干预环节，确保用户能够了解并阻止恶意工具的调用，同时呼吁用户谨慎安装工具，防范潜在的风险组合。

**要点总结**：

1.  **“Rug Pull”攻击和工具阴影**: 攻击者可以通过在工具安装后修改其定义，或通过恶意服务器覆盖可信服务器的调用，从而控制LLM的行为。这利用了LLM信任任何发送可信令牌的来源的弱点，类似于“混淆副官攻击”。
2.  **工具中毒提示注入攻击**: 攻击者将恶意指令隐藏在工具描述中，诱使LLM执行恶意操作，例如读取私有文件并将内容泄露给攻击者。这种攻击方式隐蔽性强，用户难以察觉。
3.  **WhatsApp MCP漏洞**: 通过模拟攻击，展示了攻击者如何利用WhatsApp MCP服务器的漏洞，窃取用户的消息历史，并将数据发送给指定的接收者。攻击利用了客户端界面隐藏水平滚动条的特性，使用户难以发现数据泄露。
4.  **混合使用工具和不受信任的指令具有内在危险**: 即使没有其他恶意MCP服务器，WhatsApp服务器仍然可能受到攻击。通过构造包含恶意指令的WhatsApp消息，攻击者可以诱导LLM执行未经授权的操作，例如转发消息给指定的号码。
5.  **人为干预是关键**: 强调在MCP客户端和服务端设计中，必须加入人为干预环节，确保用户能够了解正在调用的工具，并在操作执行前进行确认。建议将MCP规范中关于人为干预的“应该”视为“必须”，以提高安全性。

